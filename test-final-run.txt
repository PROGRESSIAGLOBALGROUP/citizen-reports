
> test:unit
> cross-env NODE_OPTIONS=--experimental-vm-modules jest --runInBand --detectOpenHandles

(node:20720) ExperimentalWarning: VM Modules is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
::ffff:127.0.0.1 - - [13/Nov/2025:13:54:26 +0000] "POST /api/auth/login HTTP/1.1" 200 268 "-" "-"
::ffff:127.0.0.1 - - [13/Nov/2025:13:54:26 +0000] "GET /api/reportes/1 HTTP/1.1" 200 281 "-" "-"
::ffff:127.0.0.1 - - [13/Nov/2025:13:54:26 +0000] "GET /api/reportes/9999 HTTP/1.1" 404 33 "-" "-"
::ffff:127.0.0.1 - - [13/Nov/2025:13:54:26 +0000] "GET /api/reportes/1/asignaciones HTTP/1.1" 200 318 "-" "-"
::ffff:127.0.0.1 - - [13/Nov/2025:13:54:26 +0000] "GET /api/reportes/9999/asignaciones HTTP/1.1" 404 33 "-" "-"
  console.log
    Ã”Â£Ã  Audit trail: Asignaciâ”œâ”‚n registrada (reporte 10, funcionario Juan Pâ”œÂ®rez - Obras)

      at Statement.<anonymous> (server/asignaciones-routes.js:197:25)

::ffff:127.0.0.1 - - [13/Nov/2025:13:54:26 +0000] "POST /api/reportes/10/asignaciones HTTP/1.1" 201 104 "-" "-"
::ffff:127.0.0.1 - - [13/Nov/2025:13:54:26 +0000] "POST /api/reportes/10/asignaciones HTTP/1.1" 400 44 "-" "-"
  console.log
    Ã”Â£Ã  Audit trail: Asignaciâ”œâ”‚n registrada (reporte 11, funcionario Juan Pâ”œÂ®rez - Obras)

      at Statement.<anonymous> (server/asignaciones-routes.js:197:25)

::ffff:127.0.0.1 - - [13/Nov/2025:13:54:26 +0000] "POST /api/reportes/11/asignaciones HTTP/1.1" 201 104 "-" "-"
::ffff:127.0.0.1 - - [13/Nov/2025:13:54:26 +0000] "POST /api/reportes/11/asignaciones HTTP/1.1" 409 55 "-" "-"
::ffff:127.0.0.1 - - [13/Nov/2025:13:54:26 +0000] "POST /api/reportes/9999/asignaciones HTTP/1.1" 404 33 "-" "-"
::ffff:127.0.0.1 - - [13/Nov/2025:13:54:26 +0000] "POST /api/reportes/10/asignaciones HTTP/1.1" 404 33 "-" "-"
::ffff:127.0.0.1 - - [13/Nov/2025:13:54:26 +0000] "DELETE /api/reportes/20/asignaciones/9999 HTTP/1.1" 404 37 "-" "-"
::ffff:127.0.0.1 - - [13/Nov/2025:13:54:26 +0000] "PUT /api/reportes/30/notas HTTP/1.1" 403 45 "-" "-"
::ffff:127.0.0.1 - - [13/Nov/2025:13:54:26 +0000] "PUT /api/reportes/30/notas HTTP/1.1" 400 63 "-" "-"
::ffff:127.0.0.1 - - [13/Nov/2025:13:54:26 +0000] "PUT /api/reportes/30/notas HTTP/1.1" 400 63 "-" "-"
  console.error
    Error eliminando tmpDir: Error: EBUSY: resource busy or locked, unlink 'C:\Users\Wilder\AppData\Local\Temp\jantetelco-asignaciones-bmMMF9\test.db'
        at unlinkSync (node:fs:1953:11)
        at _unlinkSync (node:internal/fs/rimraf:215:14)
        at rimrafSync (node:internal/fs/rimraf:196:7)
        at node:internal/fs/rimraf:254:9
        at Array.forEach (<anonymous>)
        at _rmdirSync (node:internal/fs/rimraf:251:7)
        at rimrafSync (node:internal/fs/rimraf:194:7)
        at Object.rmSync (node:fs:1248:10)
        at Timeout._onTimeout (C:\PROYECTOS\citizen-reports\tests\backend\asignaciones.test.js:52:18)
        at listOnTimeout (node:internal/timers:594:17)
        at processTimers (node:internal/timers:529:7) {
      errno: -4082,
      code: 'EBUSY',
      syscall: 'unlink',
      path: 'C:\\Users\\Wilder\\AppData\\Local\\Temp\\jantetelco-asignaciones-bmMMF9\\test.db'
    }

    [0m [90m 52 |[39m               fs[33m.[39mrmSync(tmpDir[33m,[39m { recursive[33m:[39m [36mtrue[39m[33m,[39m force[33m:[39m [36mtrue[39m })[33m;[39m
     [90m 53 |[39m             } [36mcatch[39m (err) {
    [31m[1m>[22m[39m[90m 54 |[39m               console[33m.[39merror([32m'Error eliminando tmpDir:'[39m[33m,[39m err)[33m;[39m
     [90m    |[39m                       [31m[1m^[22m[39m
     [90m 55 |[39m             }
     [90m 56 |[39m           }
     [90m 57 |[39m           [36mdelete[39m process[33m.[39menv[33m.[39m[33mDB_PATH[39m[33m;[39m[0m

      at Timeout._onTimeout (tests/backend/asignaciones.test.js:54:23)

PASS tests/backend/asignaciones.test.js
  Asignaciones de Reportes API
    GET /api/reportes/:id
      Ã”ÃªÃœ debe retornar detalles completos de un reporte (27 ms)
      Ã”ÃªÃœ debe retornar 404 si el reporte no existe (14 ms)
    GET /api/reportes/:id/asignaciones
      Ã”ÃªÃœ debe retornar lista de asignaciones para un reporte (20 ms)
      Ã”ÃªÃœ debe retornar 404 si el reporte no existe (16 ms)
    POST /api/reportes/:id/asignaciones
      Ã”ÃªÃœ debe crear una asignaciâ”œâ”‚n vâ”œÃ­lida (54 ms)
      Ã”ÃªÃœ debe fallar si falta usuario_id (17 ms)
      Ã”ÃªÃœ debe prevenir asignaciones duplicadas (58 ms)
      Ã”ÃªÃœ debe fallar si el reporte no existe (16 ms)
      Ã”ÃªÃœ debe fallar si el usuario no existe (18 ms)
    DELETE /api/reportes/:id/asignaciones/:usuarioId
      Ã”ÃªÃœ debe retornar 404 si la asignaciâ”œâ”‚n no existe (13 ms)
    PUT /api/reportes/:id/notas
      Ã”ÃªÃœ debe fallar si el usuario no estâ”œÃ­ asignado (15 ms)
      Ã”ÃªÃœ debe fallar si faltan notas (13 ms)
      Ã”ÃªÃœ debe fallar si las notas estâ”œÃ­n vacâ”œÂ¡as (14 ms)

::ffff:127.0.0.1 - - [13/Nov/2025:13:54:27 +0000] "POST /api/reportes HTTP/1.1" 201 50 "-" "-"
::ffff:127.0.0.1 - - [13/Nov/2025:13:54:27 +0000] "GET /api/reportes?tipo=quema HTTP/1.1" 200 232 "-" "-"
::ffff:127.0.0.1 - - [13/Nov/2025:13:54:27 +0000] "GET /api/reportes/tipos HTTP/1.1" 200 236 "-" "-"
::ffff:127.0.0.1 - - [13/Nov/2025:13:54:27 +0000] "POST /api/reportes HTTP/1.1" 400 28 "-" "-"
::ffff:127.0.0.1 - - [13/Nov/2025:13:54:27 +0000] "POST /api/reportes HTTP/1.1" 201 50 "-" "-"
::ffff:127.0.0.1 - - [13/Nov/2025:13:54:27 +0000] "POST /api/reportes HTTP/1.1" 201 50 "-" "-"
::ffff:127.0.0.1 - - [13/Nov/2025:13:54:27 +0000] "POST /api/reportes HTTP/1.1" 201 50 "-" "-"
::ffff:127.0.0.1 - - [13/Nov/2025:13:54:27 +0000] "GET /api/reportes/grid?tipo=bache&cell=0.001 HTTP/1.1" 200 44 "-" "-"
::ffff:127.0.0.1 - - [13/Nov/2025:13:54:27 +0000] "GET /api/reportes/geojson?tipo=derribo HTTP/1.1" 200 236 "-" "-"
FAIL tests/backend/reportes.test.js


  Ã”Ã¹Ã… Test suite failed to run

    EBUSY: resource busy or locked, unlink 'C:\Users\Wilder\AppData\Local\Temp\jantetelco-R1NNmV\test.db'

      39 | 	afterAll(() => {
      40 | 		if (tmpDir) {
    > 41 | 			fs.rmSync(tmpDir, { recursive: true, force: true });
         | 			   ^
      42 | 		}
      43 | 		delete process.env.DB_PATH;
      44 | 		global.fetch = originalFetch;

          at Array.forEach (<anonymous>)
      at Object.<anonymous> (tests/backend/reportes.test.js:41:7)

::ffff:127.0.0.1 - - [13/Nov/2025:13:54:28 +0000] "POST /api/auth/login HTTP/1.1" 200 285 "-" "-"
::ffff:127.0.0.1 - - [13/Nov/2025:13:54:28 +0000] "POST /api/auth/login HTTP/1.1" 200 268 "-" "-"
::ffff:127.0.0.1 - - [13/Nov/2025:13:54:28 +0000] "POST /api/reportes HTTP/1.1" 201 48 "-" "-"
::ffff:127.0.0.1 - - [13/Nov/2025:13:54:28 +0000] "POST /api/reportes/12/asignar HTTP/1.1" 403 59 "-" "-"
::ffff:127.0.0.1 - - [13/Nov/2025:13:54:28 +0000] "POST /api/reportes HTTP/1.1" 201 48 "-" "-"
  console.log
    Ã”Â£Ã  Audit trail: Asignaciâ”œâ”‚n registrada (reporte 13, funcionario Marâ”œÂ¡a Lâ”œâ”‚pez - Servicios)

      at Statement.<anonymous> (server/asignaciones-routes.js:197:25)

::ffff:127.0.0.1 - - [13/Nov/2025:13:54:28 +0000] "POST /api/reportes/13/asignaciones HTTP/1.1" 201 143 "-" "-"
::ffff:127.0.0.1 - - [13/Nov/2025:13:54:28 +0000] "POST /api/reportes HTTP/1.1" 201 48 "-" "-"
  console.log
    Ã”Â£Ã  Audit trail: Asignaciâ”œâ”‚n registrada (reporte 14, funcionario Marâ”œÂ¡a Lâ”œâ”‚pez - Servicios)

      at Statement.<anonymous> (server/asignaciones-routes.js:197:25)

::ffff:127.0.0.1 - - [13/Nov/2025:13:54:28 +0000] "POST /api/reportes/14/asignaciones HTTP/1.1" 201 167 "-" "-"
  console.error
    Error eliminando tmpDir: Error: EBUSY: resource busy or locked, unlink 'C:\Users\Wilder\AppData\Local\Temp\jantetelco-cXCzti\test.db'
        at unlinkSync (node:fs:1953:11)
        at _unlinkSync (node:internal/fs/rimraf:215:14)
        at rimrafSync (node:internal/fs/rimraf:196:7)
        at node:internal/fs/rimraf:254:9
        at Array.forEach (<anonymous>)
        at _rmdirSync (node:internal/fs/rimraf:251:7)
        at rimrafSync (node:internal/fs/rimraf:194:7)
        at Object.rmSync (node:fs:1248:10)
        at Timeout._onTimeout (C:\PROYECTOS\citizen-reports\tests\backend\asignacion-interdepartamental.test.js:70:18)
        at listOnTimeout (node:internal/timers:594:17)
        at processTimers (node:internal/timers:529:7) {
      errno: -4082,
      code: 'EBUSY',
      syscall: 'unlink',
      path: 'C:\\Users\\Wilder\\AppData\\Local\\Temp\\jantetelco-cXCzti\\test.db'
    }

    [0m [90m 70 |[39m               fs[33m.[39mrmSync(tmpDir[33m,[39m { recursive[33m:[39m [36mtrue[39m[33m,[39m force[33m:[39m [36mtrue[39m })[33m;[39m
     [90m 71 |[39m             } [36mcatch[39m (err) {
    [31m[1m>[22m[39m[90m 72 |[39m               console[33m.[39merror([32m'Error eliminando tmpDir:'[39m[33m,[39m err)[33m;[39m
     [90m    |[39m                       [31m[1m^[22m[39m
     [90m 73 |[39m             }
     [90m 74 |[39m           }
     [90m 75 |[39m           [36mdelete[39m process[33m.[39menv[33m.[39m[33mDB_PATH[39m[33m;[39m[0m

      at Timeout._onTimeout (tests/backend/asignacion-interdepartamental.test.js:72:23)

PASS tests/backend/asignacion-interdepartamental.test.js
  Asignaciâ”œâ”‚n interdepartamental de reportes
    Ã”ÃªÃœ supervisor NO puede asignar reporte de otra dependencia usando ruta /asignar (41 ms)
    Ã”ÃªÃœ admin PUEDE asignar reporte interdepartamentalmente usando /asignaciones (56 ms)
    Ã”ÃªÃœ supervisor PUEDE asignar reporte interdepartamentalmente usando /asignaciones (50 ms)

::ffff:127.0.0.1 - - [13/Nov/2025:13:54:29 +0000] "POST /api/reportes HTTP/1.1" 201 50 "-" "-"
  console.log
    Ã”Â£Ã  Audit trail: Asignaciâ”œâ”‚n registrada (reporte 12, funcionario Supervisor Obras Pâ”œâ•‘blicas)

      at Statement.<anonymous> (server/asignaciones-routes.js:197:25)

::ffff:127.0.0.1 - - [13/Nov/2025:13:54:29 +0000] "POST /api/reportes/12/asignaciones HTTP/1.1" 201 118 "-" "-"
  console.log
    Ã”Â£Ã  Audit trail: Asignaciâ”œâ”‚n registrada (reporte 12, funcionario Juan Pâ”œÂ®rez - Obras)

      at Statement.<anonymous> (server/asignaciones-routes.js:197:25)

::ffff:127.0.0.1 - - [13/Nov/2025:13:54:29 +0000] "POST /api/reportes/12/asignaciones HTTP/1.1" 201 118 "-" "-"
  console.log
    Ã”Â£Ã  Audit trail: Desasignaciâ”œâ”‚n registrada (reporte 12, funcionario Supervisor Obras Pâ”œâ•‘blicas)

      at Statement.<anonymous> (server/asignaciones-routes.js:282:17)

::ffff:127.0.0.1 - - [13/Nov/2025:13:54:29 +0000] "DELETE /api/reportes/12/asignaciones/2 HTTP/1.1" 200 61 "-" "-"
  console.log
    Ã”Â£Ã  Audit trail: Desasignaciâ”œâ”‚n registrada (reporte 12, funcionario Juan Pâ”œÂ®rez - Obras)

      at Statement.<anonymous> (server/asignaciones-routes.js:282:17)

::ffff:127.0.0.1 - - [13/Nov/2025:13:54:29 +0000] "DELETE /api/reportes/12/asignaciones/3 HTTP/1.1" 200 87 "-" "-"
::ffff:127.0.0.1 - - [13/Nov/2025:13:54:29 +0000] "POST /api/reportes HTTP/1.1" 201 50 "-" "-"
  console.log
    Ã”Â£Ã  Audit trail: Asignaciâ”œâ”‚n registrada (reporte 13, funcionario Supervisor Obras Pâ”œâ•‘blicas)

      at Statement.<anonymous> (server/asignaciones-routes.js:197:25)

::ffff:127.0.0.1 - - [13/Nov/2025:13:54:29 +0000] "POST /api/reportes/13/asignaciones HTTP/1.1" 201 116 "-" "-"
  console.log
    Ã”Â£Ã  Audit trail: Desasignaciâ”œâ”‚n registrada (reporte 13, funcionario Supervisor Obras Pâ”œâ•‘blicas)

      at Statement.<anonymous> (server/asignaciones-routes.js:282:17)

::ffff:127.0.0.1 - - [13/Nov/2025:13:54:29 +0000] "DELETE /api/reportes/13/asignaciones/2 HTTP/1.1" 200 87 "-" "-"
PASS tests/backend/desasignacion-estado.test.js
  Estado del reporte tras desasignaciâ”œâ”‚n
    Ã”ÃªÃœ Estado cambia a "abierto" cuando se eliminan todas las asignaciones (185 ms)
    Ã”ÃªÃœ Estado NO cambia si el reporte estâ”œÃ­ en "pendiente_cierre" (89 ms)

::ffff:127.0.0.1 - - [13/Nov/2025:13:54:30 +0000] "POST /api/auth/login HTTP/1.1" 200 268 "-" "-"
::ffff:127.0.0.1 - - [13/Nov/2025:13:54:30 +0000] "GET /api/usuarios?dependencia=obras_publicas HTTP/1.1" 200 442 "-" "-"
::ffff:127.0.0.1 - - [13/Nov/2025:13:54:30 +0000] "GET /api/usuarios?rol=funcionario HTTP/1.1" 200 888 "-" "-"
::ffff:127.0.0.1 - - [13/Nov/2025:13:54:30 +0000] "GET /api/usuarios?dependencia=servicios_publicos&rol=funcionario HTTP/1.1" 200 230 "-" "-"
::ffff:127.0.0.1 - - [13/Nov/2025:13:54:30 +0000] "GET /api/usuarios?dependencia=dependencia_inexistente HTTP/1.1" 200 2 "-" "-"
  console.error
    Error eliminando tmpDir: Error: EBUSY: resource busy or locked, unlink 'C:\Users\Wilder\AppData\Local\Temp\jantetelco-usuarios-uC72XJ\test.db'
        at unlinkSync (node:fs:1953:11)
        at _unlinkSync (node:internal/fs/rimraf:215:14)
        at rimrafSync (node:internal/fs/rimraf:196:7)
        at node:internal/fs/rimraf:254:9
        at Array.forEach (<anonymous>)
        at _rmdirSync (node:internal/fs/rimraf:251:7)
        at rimrafSync (node:internal/fs/rimraf:194:7)
        at Object.rmSync (node:fs:1248:10)
        at Timeout._onTimeout (C:\PROYECTOS\citizen-reports\tests\backend\usuarios-filtros.test.js:48:11)
        at listOnTimeout (node:internal/timers:594:17)
        at processTimers (node:internal/timers:529:7) {
      errno: -4082,
      code: 'EBUSY',
      syscall: 'unlink',
      path: 'C:\\Users\\Wilder\\AppData\\Local\\Temp\\jantetelco-usuarios-uC72XJ\\test.db'
    }

    [0m [90m 48 |[39m 							fs[33m.[39mrmSync(tmpDir[33m,[39m { recursive[33m:[39m [36mtrue[39m[33m,[39m force[33m:[39m [36mtrue[39m })[33m;[39m
     [90m 49 |[39m 						} [36mcatch[39m (err) {
    [31m[1m>[22m[39m[90m 50 |[39m 							console[33m.[39merror([32m'Error eliminando tmpDir:'[39m[33m,[39m err)[33m;[39m
     [90m    |[39m 							        [31m[1m^[22m[39m
     [90m 51 |[39m 						}
     [90m 52 |[39m 					}
     [90m 53 |[39m 					[36mdelete[39m process[33m.[39menv[33m.[39m[33mDB_PATH[39m[33m;[39m[0m

      at Timeout._onTimeout (tests/backend/usuarios-filtros.test.js:50:16)

PASS tests/backend/usuarios-filtros.test.js
  API usuarios - filtros de asignaciâ”œâ”‚n
    Ã”ÃªÃœ filtra usuarios por dependencia (18 ms)
    Ã”ÃªÃœ filtra usuarios por rol (13 ms)
    Ã”ÃªÃœ filtra usuarios por dependencia y rol (12 ms)
    Ã”ÃªÃœ devuelve array vacâ”œÂ¡o si no hay matches (15 ms)

PASS tests/backend/restore-validate.test.js
  restore validation utilities
    Ã”ÃªÃœ extractArchive unpacks tarball into temp dir (37 ms)
    Ã”ÃªÃœ findDatabaseFile locates nested sqlite db (4 ms)
    Ã”ÃªÃœ runSqliteIntegrityCheck skips when binary missing (6 ms)
    Ã”Ã¹Ã¯ skipped downloadArchive supports s3 scheme (AWS not used in this project)
    Ã”Ã¹Ã¯ skipped downloadArchive supports azblob scheme (Azure not used in this project)

::ffff:127.0.0.1 - - [13/Nov/2025:13:54:32 +0000] "GET /api/reportes HTTP/1.1" 200 - "-" "-"
::ffff:127.0.0.1 - - [13/Nov/2025:13:54:32 +0000] "GET /api/reportes?tipo=bache HTTP/1.1" 200 207 "-" "-"
  console.error
    Error eliminando tmpDir: Error: EBUSY: resource busy or locked, unlink 'C:\Users\Wilder\AppData\Local\Temp\jantetelco-estado-JbYddJ\test.db'
        at unlinkSync (node:fs:1953:11)
        at _unlinkSync (node:internal/fs/rimraf:215:14)
        at rimrafSync (node:internal/fs/rimraf:196:7)
        at node:internal/fs/rimraf:254:9
        at Array.forEach (<anonymous>)
        at _rmdirSync (node:internal/fs/rimraf:251:7)
        at rimrafSync (node:internal/fs/rimraf:194:7)
        at Object.rmSync (node:fs:1248:10)
        at Timeout._onTimeout (C:\PROYECTOS\citizen-reports\tests\backend\reportes-estado.test.js:47:18)
        at listOnTimeout (node:internal/timers:594:17)
        at processTimers (node:internal/timers:529:7) {
      errno: -4082,
      code: 'EBUSY',
      syscall: 'unlink',
      path: 'C:\\Users\\Wilder\\AppData\\Local\\Temp\\jantetelco-estado-JbYddJ\\test.db'
    }

    [0m [90m 47 |[39m               fs[33m.[39mrmSync(tmpDir[33m,[39m { recursive[33m:[39m [36mtrue[39m[33m,[39m force[33m:[39m [36mtrue[39m })[33m;[39m
     [90m 48 |[39m             } [36mcatch[39m (err) {
    [31m[1m>[22m[39m[90m 49 |[39m               console[33m.[39merror([32m'Error eliminando tmpDir:'[39m[33m,[39m err)[33m;[39m
     [90m    |[39m                       [31m[1m^[22m[39m
     [90m 50 |[39m             }
     [90m 51 |[39m           }
     [90m 52 |[39m           [36mdelete[39m process[33m.[39menv[33m.[39m[33mDB_PATH[39m[33m;[39m[0m

      at Timeout._onTimeout (tests/backend/reportes-estado.test.js:49:23)

PASS tests/backend/reportes-estado.test.js
  API reportes - campo estado
    Ã”ÃªÃœ GET /api/reportes debe incluir campo estado (61 ms)
    Ã”ÃªÃœ GET /api/reportes con filtro debe incluir campo estado (13 ms)

PASS tests/backend/maintenance.test.js
  maintenance orchestrator utilities
    Ã”ÃªÃœ parseArgs captures flags and positional params (3 ms)
    Ã”ÃªÃœ buildSteps includes both tasks by default (1 ms)
    Ã”ÃªÃœ buildSteps respects skip flags and template override (1 ms)
    Ã”ÃªÃœ determineStatus returns degraded when exit code matches list (9 ms)
    Ã”ÃªÃœ executeSteps aggregates statuses and honors fail-fast (1 ms)
    Ã”ÃªÃœ summarize computes counts and exit code (1 ms)
    Ã”ÃªÃœ parseLabels converts comma-separated values into an object (1 ms)
    Ã”ÃªÃœ resolveMetricsLabels merges env defaults with CLI overrides (1 ms)
    Ã”ÃªÃœ buildMetricsPayload emits Prometheus text format (1 ms)
    Ã”ÃªÃœ writeMetricsFile writes payload to disk (4 ms)
    Ã”ÃªÃœ pruneBackups deletes old files and keeps newest ones (7 ms)
    Ã”ÃªÃœ compressLogFile gzips target and truncates original (14 ms)
    Ã”ÃªÃœ getLatestBackupFile returns most recent backup path (27 ms)
    Ã”ÃªÃœ createArchive bundles sources and notes (40 ms)
    Ã”ÃªÃœ parseUploadTarget valida URI correcta (4 ms)
    Ã”ÃªÃœ buildNotificationPayload compone resumen y pasos (1 ms)
    Ã”Ã¹Ã¯ skipped uploadArchive envâ”œÂ¡a archivo a S3
    Ã”Ã¹Ã¯ skipped uploadArchive envâ”œÂ¡a archivo a Azure Blob Storage
    Ã”Ã¹Ã¯ skipped sendNotification envâ”œÂ¡a POST con token Bearer

PASS tests/backend/tile-smoke.test.js
  tile smoke CLI utilities
    Ã”ÃªÃœ parseArgs handles flags and positional template (3 ms)
    Ã”ÃªÃœ parseCoords yields normalized coordinate entries (2 ms)
    Ã”ÃªÃœ parseCoords throws on out-of-range values (5 ms)
    Ã”ÃªÃœ formatUrl replaces tokens correctly (1 ms)
    Ã”ÃªÃœ summarize flags fallback responses as degraded (1 ms)
    Ã”ÃªÃœ probeTile returns error after retries exhausted (216 ms)
    Ã”Ã¹Ã¯ skipped probeTile marks fallback header and preserves fallback PNG bytes (ESM Jest mock issue)

PASS tests/backend/sanity.test.js
  Sanity Tests
    Ã”ÃªÃœ Jest estâ”œÃ­ configurado correctamente (3 ms)
    Ã”ÃªÃœ Operaciones bâ”œÃ­sicas funcionan (1 ms)
    Ã”ÃªÃœ Array operations work (5 ms)
    Ã”ÃªÃœ Object operations work (1 ms)

Test Suites: 1 failed, 1 skipped, 9 passed, 10 of 11 total
Tests:       10 skipped, 58 passed, 68 total
Snapshots:   0 total
Time:        8.938 s, estimated 12 s
Ran all test suites.

Jest has detected the following 1 open handle potentially keeping Jest from exiting:

  Ã”Ã¹Ã…  TCPWRAP

      100 |   const timer = setTimeout(() => controller.abort(new Error('timeout')), timeoutMs);
      101 |   try {
    > 102 |     const response = await fetch(url, {
          |                            ^
      103 |       ...options,
      104 |       signal: controller.signal,
      105 |     });

      at fetchWithTimeout (scripts/tile-smoke.js:102:28)
      at probeTile (scripts/tile-smoke.js:118:30)
      at Object.<anonymous> (tests/backend/tile-smoke.test.js:70:26)

