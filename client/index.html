<!doctype html>
<html lang="es">
  <head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="manifest" href="/manifest.json">
  <title>Reportes Ciudadanos - Jantetelco, Morelos</title>
  </head>
  <body>
    <div id="root"></div>
    <script>
      // ═══════════════════════════════════════════════════════════════
      // INTERCEPTAR WEBSOCKET DE VITE ANTES DE QUE SE CARGUE
      // ═══════════════════════════════════════════════════════════════
      const OriginalWebSocket = window.WebSocket;
      window.WebSocket = class ViteFilteredWebSocket extends OriginalWebSocket {
        constructor(url, ...args) {
          // Bloquear WebSocket de Vite HMR
          if (url && url.includes('localhost:5173') && url.includes('token=')) {
            console.debug('[WebSocket Filtered] Blocking Vite HMR WebSocket');
            // Crear un stub que nunca conecta
            const stub = Object.create(OriginalWebSocket.prototype);
            stub.readyState = 3; // CLOSED
            stub.send = () => {};
            stub.close = () => {};
            stub.addEventListener = () => {};
            stub.removeEventListener = () => {};
            return stub;
          }
          return new OriginalWebSocket(url, ...args);
        }
      };
      
      // Suprimir errores no críticos de Leaflet/librerías
      window.addEventListener('error', (event) => {
        if (event.message && event.message.includes('_leaflet_pos')) {
          event.preventDefault();
          return false;
        }
        if (event.message && event.message.includes('Cannot read properties of undefined')) {
          if (event.filename && event.filename.includes('leaflet')) {
            event.preventDefault();
            return false;
          }
        }
      }, true);
    </script>
    <script type="module" src="/src/main.jsx"></script>
  </body>
</html>
