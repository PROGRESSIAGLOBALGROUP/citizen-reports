{
  "job_id": "add-reabrir-reporte-feature",
  "description": "Agregar funcionalidad de reapertura de reportes cerrados y deshabilitar asignación en reportes cerrados",
  "priority": "high",
  "operations": [
    {
      "op_id": "backend-add-reabrir-endpoint",
      "type": "manual-insert",
      "target_file": "server/reportes_auth_routes.js",
      "description": "Agregar endpoint POST /api/reportes/:id/reabrir para que admins puedan reabrir reportes cerrados (insertar después de rechazar endpoint)",
      "fragment_file": "surgery/fragments/add-reabrir-endpoint.js"
    },
    {
      "op_id": "frontend-add-states",
      "type": "manual-insert",
      "target_file": "client/src/VerReporte.jsx",
      "description": "Agregar estados para modal de reapertura (después de loadingAsignacion)",
      "fragment_file": "surgery/fragments/ver-reporte-estados-reabrir.js"
    },
    {
      "op_id": "frontend-add-functions",
      "type": "manual-insert",
      "target_file": "client/src/VerReporte.jsx",
      "description": "Agregar función handleReabrirReporte (después de handleDesasignar)",
      "fragment_file": "surgery/fragments/ver-reporte-function-reabrir.js"
    },
    {
      "op_id": "frontend-add-modal",
      "type": "manual-insert",
      "target_file": "client/src/VerReporte.jsx",
      "description": "Agregar modal de confirmación de reapertura (antes del último cierre del return)",
      "fragment_file": "surgery/fragments/ver-reporte-modal-reabrir.jsx"
    }
  ],
  "validation": {
    "tests": [
      "npm run lint -- client/src/VerReporte.jsx",
      "npm run lint -- server/reportes_auth_routes.js"
    ],
    "manual_checks": [
      "Verificar que el endpoint /api/reportes/:id/reabrir existe en el servidor",
      "Verificar que el botón 'Asignar Funcionario' está deshabilitado cuando estado='cerrado'",
      "Verificar que aparece el botón 'Reabrir Reporte' para admins cuando estado='cerrado'",
      "Probar manualmente la reapertura de un reporte cerrado desde la UI"
    ]
  },
  "rollback": {
    "enabled": true,
    "on_test_fail": false
  }
}
